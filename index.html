<!DOCTYPE html><html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flappy Festivo Deluxe üê¶‚ú®</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background: linear-gradient(to bottom, #87ceeb, #4facfe);
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    canvas {
      background: linear-gradient(to bottom, #87ceeb, #dff9fb);
      border: 4px solid #222;
      border-radius: 12px;
    }
    #ui {
      position: fixed;
      bottom: 20px;
      display: flex;
      gap: 10px;
    }
    button {
      padding: 12px 20px;
      font-size: 18px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      background: #ffd166;
      color: #333;
      box-shadow: 0 8px 20px rgba(0,0,0,0.25);
    }
  </style>
</head>
<body><canvas id="game" width="360" height="520"></canvas>

<div id="ui">
  <button id="start">‚ñ∂ Jugar</button>
  <button id="musicBtn">üéµ M√∫sica</button>
</div><audio id="jumpSound" src="jump.mp3"></audio> <audio id="scoreSound" src="score.mp3"></audio> <audio id="bgMusic" src="music.mp3" loop></audio>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let frames = 0;
let score = 0;
let best = 0;
let playing = false;
let gameOver = false;

const bird = {
  x: 60,
  y: 200,
  r: 14,
  gravity: 0.25,
  lift: -4.5,
  velocity: 0,
  draw() {
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.r, 0, Math.PI * 2);
    ctx.fillStyle = "yellow";
    ctx.fill();
  },
  flap() {
    this.velocity = this.lift;
    document.getElementById("jumpSound").play();
  },
  update() {
    this.velocity += this.gravity;
    this.y += this.velocity;
    if (this.y + this.r >= canvas.height || this.y - this.r <= 0) gameOver = true;
  }
};

const pipes = [];
const gap = 120;

function createPipe() {
  const top = Math.random() * -200;
  pipes.push({ x: canvas.width, top });
}

function updatePipes() {
  for (let i = 0; i < pipes.length; i++) {
    pipes[i].x -= 2;

    const p = pipes[i];
    if (
      bird.x + bird.r > p.x && bird.x - bird.r < p.x + 50 &&
      (bird.y - bird.r < p.top + 300 || bird.y + bird.r > p.top + 300 + gap)
    ) gameOver = true;

    if (p.x === bird.x) {
      score++;
      document.getElementById("scoreSound").play();
    }
  }

  if (pipes.length && pipes[0].x < -60) pipes.shift();
}

function drawPipes() {
  ctx.fillStyle = "green";
  pipes.forEach(p => {
    ctx.fillRect(p.x, p.top, 50, 300);
    ctx.fillRect(p.x, p.top + 300 + gap, 50, 400);
  });
}

function drawScore() {
  ctx.fillStyle = "#fff";
  ctx.font = "24px Arial";
  ctx.fillText("Puntos: " + score, 10, 30);
}

function loop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  bird.update();
  bird.draw();

  if (frames % 100 === 0) createPipe();
  updatePipes();
  drawPipes();
  drawScore();

  frames++;

  if (!gameOver) requestAnimationFrame(loop);
  else {
    ctx.fillStyle = "red";
    ctx.font = "30px Arial";
    ctx.fillText("üíÄ GAME OVER", 80, 260);
    document.getElementById("bgMusic").pause();
  }
}

canvas.addEventListener("click", () => {
  if (playing && !gameOver) bird.flap();
});

document.getElementById("start").onclick = () => {
  pipes.length = 0;
  score = 0;
  frames = 0;
  bird.y = 200;
  bird.velocity = 0;
  gameOver = false;
  playing = true;
  document.getElementById("bgMusic").play();
  loop();
};

document.getElementById("musicBtn").onclick = () => {
  const m = document.getElementById("bgMusic");
  m.paused ? m.play() : m.pause();
};
</script></body>
</html>